;/*FB_PKG_DELIM*/

__d("MWChatSearchTypeaheadLightspeedDataSource",["FBLogger","LSIntEnum","LSSearchType","MAWGating","MNetRankType","MWChatSearchFilteringUtils","MWChatSearchIssueLightspeedQuery.bs","MWLSSearchIssueSearchQuerySupportedTypes.bs","MWPSearchOfflineOpenConversations.bs","Promise","asyncToGeneratorRuntime","cr:6430","createMWChatSearchTypeaheadDataEntry","mwChatSearchPayloadDecoratorRemoveDuplicates","mwChatSearchPayloadDecoratorRemoveExcluded","mwChatSearchPayloadEnumerate"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWGating").isArmadillo()&&d("MAWGating").isTlcSearchEnabled(),i=10,j=10,k=[d("LSIntEnum").ofNumber(c("LSSearchType").CONTACT)];function l(a,d,e,f){if(b("cr:6430")==null)return b("Promise").resolve([]);return d.length>0&&!d.includes("secure")?b("Promise").resolve([]):b("cr:6430").fetchResults(a,e,!0,f).then(function(a){a=a.map(c("createMWChatSearchTypeaheadDataEntry")).filter(function(a){return a.rawData.isE2EE});return j<=0?a:a.slice(0,j)})["catch"](function(a){c("FBLogger")("messenger_search").catching(a).mustfix("Error performing MWChatSearchIssueMAWFTSQuery.fetchResults");return[]})}function m(a,e,f){if(e===d("MWChatSearchIssueLightspeedQuery.bs").Surfaces.broadcast)return b("Promise").resolve([]);return a.length>0&&!a.includes("offline")?b("Promise").resolve([]):d("MWPSearchOfflineOpenConversations.bs").search(f.query,!0).then(function(a){a=a.map(c("createMWChatSearchTypeaheadDataEntry"));return i<=0?a:a.slice(0,i)})}function n(a,c,d,e){a=l(a,c,d,e);c=m(c,d,e);return b("Promise").all([a,c])}a=function(){function a(a){var b=a.excludedIDs;b=b===void 0?[]:b;var e=a.lightspeedSupportedTypes;e=e===void 0?d("MWLSSearchIssueSearchQuerySupportedTypes.bs").allSupportedTypes:e;var f=a.source;f=f===void 0?d("MWChatSearchIssueLightspeedQuery.bs").Surfaces.universal:f;var g=a.includeGroupSearch;g=g===void 0?!1:g;var h=a.excludeNonSecureThreadSearch;h=h===void 0?!1:h;var i=a.nullStateRankType;i=i===void 0?d("LSIntEnum").ofNumber(c("MNetRankType").MESSENGER_USER_SEARCH_NULLSTATE):i;var j=a.subDataSources;j=j===void 0?[]:j;a=a.database;this.$1=[];this.$2=[];this.$2=b;this.$3=e;this.$4=f;this.$5=g;this.$6=h;this.$7=i;this.$8=j;this.$9=a;this.$10=e.includes(d("LSIntEnum").ofNumber(c("LSSearchType").INTEGRATED_MESSAGE_SEARCH_THREAD))}var e=a.prototype;e.fetchNetwork=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this,f=c("mwChatSearchPayloadDecoratorRemoveDuplicates")(this.$1),g=c("mwChatSearchPayloadDecoratorRemoveExcluded")(this.$2);if(a.query.length===0)return d("MWChatSearchIssueLightspeedQuery.bs").fetchRecommendations(this.$3,this.$4,a,this.$7).then(function(d){d=d.map(c("createMWChatSearchTypeaheadDataEntry"));return b("Promise").resolve({entries:d,params:a})});var i=[];this.$10&&!this.$6&&i.push({key:a.query,label:'Search messages for "'+a.query+'"',rawData:{displayName:'Search messages for "'+a.query+'"',id:a.query,imageUrl:"",isContact:!1,isE2EE:!1,isEPD:!1,resultType:"messages",secondaryImageUrl:"",subtext:""},type:"entry"});var j=(yield n(this.$3,this.$8,this.$4,a)),l=j[0],m=j[1];j=this.$6?k:this.$3;return d("MWChatSearchIssueLightspeedQuery.bs").fetchResults(j,this.$8,this.$4,this.$5,a).then(function(){var j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b.map(c("createMWChatSearchTypeaheadDataEntry"));b=i.concat(m,l,b);b=(yield d("MWChatSearchFilteringUtils").filterSearchResults(b,e.$9,e.$6,h));return c("mwChatSearchPayloadEnumerate")(g(f({entries:b,params:a})))});return function(a){return j.apply(this,arguments)}}())});function e(b){return a.apply(this,arguments)}return e}();return a}();g["default"]=a}),98);
__d("useMWLightSpeedChatSearchSuggestedContacts",["MWChatSearchFetchContactRecommendations","createMWChatSearchTypeaheadDataEntry","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useMemo,i=void 0;function a(){var a=d("MWChatSearchFetchContactRecommendations").useChatSearchContactRecommendations(i);return h(function(){return a.map(function(a,b){a=a[0];return c("createMWChatSearchTypeaheadDataEntry")(a,b)})},[a])}g["default"]=a}),98);
__d("MWJewelSearchTypeahead.react",["fbt","BaseTypeahead.react","CometRelay","CometTypeaheadBackButton.react","CometTypeaheadInputRoundedStrategy.react","CometTypeaheadLayoutContextualStrategy.react","LsUniversalSearchEndFalcoEvent","LsUniversalSearchQueryChangedFalcoEvent","LsUniversalSearchStartFalcoEvent","MAWGating","MWChatSearchIssueLightspeedQuery.bs","MWChatSearchTypeaheadLightspeedDataSource","MWLSSearchIssueSearchQuerySupportedTypes.bs","MWLSThreadDisplayContext","MWPSearchSystem","MWSearchLogging","clearTimeout","cr:2012305","createMWJewelSearchTypeaheadViewStrategy.react","gkx","promiseDone","react","setTimeout","useMWLightSpeedChatSearchSuggestedContacts","useReStore","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");e=d("react");var j=e.useCallback,k=e.useEffect,l=e.useMemo,m=e.useRef,n=e.useState,o={searchInput:{marginTop:"x1xmf6yo",marginEnd:"x11i5rnm",marginBottom:"x1e56ztr",marginStart:"x1mh8g0r",paddingTop:"xexx8yu",paddingEnd:"x1pi30zi",paddingBottom:"x18d9i69",paddingStart:"x1swvt13",$$css:!0},searchView:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",boxShadow:"x1gnnqk1",display:"x78zum5",minHeight:"xphu8jj",$$css:!0}},p=c("createMWJewelSearchTypeaheadViewStrategy.react")(),q=["1001"],r=c("gkx")("6395");function a(a){var e=a.onChange,f=a.onFocus,g=a.onPressEntry,s=a.onSelectFreeformQuery,t=babelHelpers.objectWithoutPropertiesLoose(a,["onChange","onFocus","onPressEntry","onSelectFreeformQuery"]);a=n(null);var u=a[0],v=a[1],w=d("CometRelay").useRelayEnvironment(),x=m(null),y=m(null),z=c("useReStore")(),A=m(!1);k(function(){var a=y.current;b("cr:2012305")!==null&&a!=null&&b("cr:2012305").trackTypingPerf(a,"MWJewelSearchTypeahead");return function(){b("cr:2012305")!==null&&a!=null&&b("cr:2012305").unregisterTypingPerf(a)}},[y]);var B=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();a=l(function(){return new(c("MWChatSearchTypeaheadLightspeedDataSource"))({excludedIDs:[],includeGroupSearch:B!=="ChatTab",includeRecommendations:!0,lightspeedSupportedTypes:d("MWLSSearchIssueSearchQuerySupportedTypes.bs").allSupportedTypesWithMessageSearch,limit:20,relayEnvironment:w,source:d("MWChatSearchIssueLightspeedQuery.bs").Surfaces.universal})},[w,B]);var C=j(function(){v(null),u!=null&&(c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:0,instance_id:u,recipient_ids:q}}),A.current||x.current!=null&&(c("clearTimeout")(x.current),x.current=null)),e("")},[e,u]),D=j(function(a){var b=function(){x.current!=null&&(c("clearTimeout")(x.current),x.current=null),g!=null&&g(a)};if(u==null){b();return}d("MWSearchLogging").logResultSelected(u,t.queryString,a,q,A);b()},[g,u,t.queryString]),E=j(function(){r&&c("promiseDone")(d("MWPSearchSystem").clearAll(z));var a=c("uuidv4")();v(a);A.current=!1;c("LsUniversalSearchStartFalcoEvent").log(function(){return{instance_id:a}});x.current=c("setTimeout")(function(){c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:3,instance_id:a,recipient_ids:q}})},3e4)},[z]),F=j(function(a){u!=null&&c("LsUniversalSearchQueryChangedFalcoEvent").log(function(){return{instance_id:u,query_string:a}}),e(a)},[e,u]),G=c("useMWLightSpeedChatSearchSuggestedContacts")();return i.jsx(c("BaseTypeahead.react"),{dataSource:a,dataSourceFetchConfigParams:d("MAWGating").isArmadillo()?{requestFlow:"network-upon-approve"}:{},emptyEntries_DO_NOT_USE:G,inputExtraProps:{hideIconAnimation:!0,hideIconOnFocus:!0},inputRef:y,inputStartContent:u!=null?i.jsx(c("CometTypeaheadBackButton.react"),{testid:void 0}):null,inputStrategyRenderer:c("CometTypeaheadInputRoundedStrategy.react"),layoutStrategyRenderer:c("CometTypeaheadLayoutContextualStrategy.react"),loggingContext:"messenger_jewel",onChange:F,onClose:C,onFocus:f,onOpen:E,onPressEntry:D,onSelectFreeformQuery:s,placeholder:h._("__JHASH__ktsKn3dbNLm__JHASH__"),queryString:t.queryString,shouldQueryStringUpdateFromSelectedEntryOnClick:!1,viewStrategyRenderer:p,xstyles:{inputXStyle:o.searchInput,viewXStyle_DO_NOT_USE:o.searchView}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometReshareDialogTargetSection.react",["CometUnit.react","CometUnitHeader.react","TetraList.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.children,d=a.sectionTitle,e=a.subtitle;a=a.testid;a=a===void 0?"":a;return h.jsx(c("CometUnit.react"),{header:h.jsx(c("CometUnitHeader.react"),{body:e,headline:d,level:3}),testid:void 0,children:h.jsx(c("TetraList.react"),{children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometResharesConstants",[],(function(a,b,c,d,e,f){"use strict";a=3e3;f.UNDO_DELAY_MS=a}),66);
__d("CometResharesSearchInputStrategy.react",["CometTypeaheadInputRoundedStrategy.react","MWPSearchSystem","emptyFunction","gkx","qex","react","useCometPreloader","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useCallback;function a(a,b){var e=c("useReStore")(),f=i(function(){var a=c("gkx")("4164");a=a&&((a=c("qex")._("73"))!=null?a:!1);a&&d("MWPSearchSystem").makeAll(e)},[e]);f=c("useCometPreloader")("button_aggressive",c("emptyFunction"),f);var g=f[0];f=f[1];return h.jsx("div",{onMouseEnter:g,onMouseLeave:f,children:h.jsx(c("CometTypeaheadInputRoundedStrategy.react"),babelHelpers["extends"]({},a,{ref:b}))})}a.displayName=a.name+" [from "+f.id+"]";b=h.forwardRef(a);g["default"]=b}),98);
__d("MwbBreadthForwardingLimitReachedBannerShownFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("801");b=d("FalcoLoggerInternal").create("mwb_breadth_forwarding_limit_reached_banner_shown",a);e=b;g["default"]=e}),98);
__d("CometResharesSearchTargetsArea.react",["fbt","BaseTypeahead.react","CometResharesSearchInputStrategy.react","CometScrollableArea.react","CometTypeaheadLayoutInlineStrategy.react","CometTypeaheadProgressGlimmer.react","CometTypeaheadViewEmptyState.react","MWPSearchSystem","MwbBreadthForwardingLimitReachedBannerShownFalcoEvent","TetraText.react","gkx","qex","react","stylex","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");b=d("react");var j=b.useCallback,k=b.useMemo,l=b.useState,m=5,n={input:{marginBottom:"xod5an3",marginEnd:"xktsk01",marginStart:"x1d52u69",marginTop:"x14vqqas",$$css:!0},view:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",height:"x16nrsnc",$$css:!0},withTopDivider:{borderTop:"x1n2xptk",marginTop:"xw7yly9",$$css:!0}};function a(a){var b=a.canForward,e=a.dataSource;a.dropSecureThreadToggle;var f=a.initialQueryString;f=f===void 0?"":f;var g=a.noSearchResultsText,o=a.placeholder,p=a.renderResults,q=a.suggestedTargets;a=a.withTopDivider;a=a===void 0?!0:a;f=l((f=f)!=null?f:"");var r=f[0];f=f[1];var s=l(!1),t=s[0];s=s[1];var u=c("useReStore")(),v=j(function(){var a=c("gkx")("4164");a=a&&((a=c("qex")._("73"))!=null?a:!1);a===!0&&d("MWPSearchSystem").makeAll(u)},[u]),w=k(function(){return function(a){var b=a.entries,d=a.isLoading;a=a.queryString;a=((a=a==null?void 0:a.length)!=null?a:0)>0;if(!a)return i.jsx(c("CometScrollableArea.react"),{horizontal:!1,xstyle:n.view,children:q});return b.length===0?i.jsx(c("CometTypeaheadViewEmptyState.react"),{children:g}):i.jsxs(c("CometScrollableArea.react"),{horizontal:!1,xstyle:n.view,children:[d&&i.jsx(c("CometTypeaheadProgressGlimmer.react"),{}),p({entries:b})]})}},[q,p,g]);if(!b){t||(c("MwbBreadthForwardingLimitReachedBannerShownFalcoEvent").log(function(){return{limit:m.toString()}}),s(!0));return i.jsxs("div",{className:c("stylex")(a&&n.withTopDivider),"data-testid":void 0,children:[i.jsx("div",{className:"x5hsz1j x10e4vud x1v7wizp x190cc1c xq82lqc xlhe6ec x1lq5wgf xgqcy7u x30kzoy x9jhf4c x10w6t97 x1d52u69 x1xmf6yo x1swvt13 xyamay9 x10l6tqk xloyg6u x1vjfegm","data-testid":void 0,children:i.jsxs(c("TetraText.react"),{color:"primary",type:"headline3",children:[h._("__JHASH__ziMwr5yUHFi__JHASH__")," "]})}),i.jsx(c("BaseTypeahead.react"),{dataSource:e,inputStrategyRenderer:c("CometResharesSearchInputStrategy.react"),layoutStrategyRenderer:c("CometTypeaheadLayoutInlineStrategy.react"),onChange:f,onFocus:v,placeholder:o,queryString:r,shouldQueryStringFollowHighlightedEntry:!1,shouldQueryStringUpdateFromSelectedEntryOnClick:!1,viewStrategyRenderer:w,xstyles:{inputXStyle:n.input,viewXStyle_DO_NOT_USE:n.view}})]})}return i.jsx("div",{className:c("stylex")(a&&n.withTopDivider),"data-testid":void 0,children:i.jsx(c("BaseTypeahead.react"),{dataSource:e,inputStrategyRenderer:c("CometResharesSearchInputStrategy.react"),layoutStrategyRenderer:c("CometTypeaheadLayoutInlineStrategy.react"),onChange:f,onFocus:v,placeholder:o,queryString:r,shouldQueryStringFollowHighlightedEntry:!1,shouldQueryStringUpdateFromSelectedEntryOnClick:!1,testid:void 0,viewStrategyRenderer:w,xstyles:{inputXStyle:n.input,viewXStyle_DO_NOT_USE:n.view}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("usePopPage",["BaseMultiPageViewContext","react","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useContext;function a(){var a=i(c("BaseMultiPageViewContext")),b=h(function(){c("recoverableViolation")("usePushPage can only be used inside BaseMultiPageView.","BaseMultiPageView");return},[]);if(a==null)return b;return a.popPage==null?null:a.popPage}g["default"]=a}),98);